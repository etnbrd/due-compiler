<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <title>Due</title>
    <meta content="Dues are a simpler alternative to Promises. We present a compiler from callbacks to Dues as a first step towart the compilation from callback to Promises" name="description">
    <meta content="width=device-width,initial-scale=1" name="viewport">

    <link href="styles/prism.css" rel="stylesheet" type="text/css" />

    <style>

      @import url(http://fonts.googleapis.com/css?family=Roboto:300,900);
      @import url(http://fonts.googleapis.com/css?family=Inconsolata);
      @import url(http://weloveiconfonts.com/api/?family=fontawesome);

      * {
        padding: 0;
        margin: 0;
      }

      html {
        width: 100%;
        height: 100%;
      }

      body {
        width: 700px;
        max-width: 80%;
        margin: auto;
        padding: 10% 0;
      }

      h1, h2, h3 {
        font-weight: 900;
        font-family: "Roboto";
      }

      h1 {
        padding: 75px 16px 0px 16px;
        color: white;
        /*text-shadow: 0 -1px 6px rgba(50, 50, 50, 0.05), 0 1px 6px rgba(50, 50, 50, 0.05), 1px 0 6px rgba(50, 50, 50, 0.05), -1px 0 6px rgba(50, 50, 50, 0.05);*/
        background: rgb(255, 0, 73);
        border-radius: 1px;
        border: 1px solid rgb(200, 0, 73);

        margin-bottom: 40px;

        /*text-align: right;*/

        overflow: hidden;

        text-shadow: 1px  1px 0 rgb(230, 0, 68), 2px  2px 0 rgb(230, 0, 68), 3px  3px 0 rgb(230, 0, 68), 4px  4px 0 rgb(230, 0, 68), 5px  5px 0 rgb(230, 0, 68), 6px  6px 0 rgb(230, 0, 68), 7px  7px 0 rgb(230, 0, 68), 8px  8px 0 rgb(230, 0, 68), 9px  9px 0 rgb(230, 0, 68),10px 10px 0 rgb(230, 0, 68),11px 11px 0 rgb(230, 0, 68),12px 12px 0 rgb(230, 0, 68),13px 13px 0 rgb(230, 0, 68),14px 14px 0 rgb(230, 0, 68),15px 15px 0 rgb(230, 0, 68),16px 16px 0 rgb(230, 0, 68),17px 17px 0 rgb(230, 0, 68),18px 18px 0 rgb(230, 0, 68),19px 19px 0 rgb(230, 0, 68),20px 20px 0 rgb(230, 0, 68),21px 21px 0 rgb(230, 0, 68),22px 22px 0 rgb(230, 0, 68),23px 23px 0 rgb(230, 0, 68),24px 24px 0 rgb(230, 0, 68),25px 25px 0 rgb(230, 0, 68),26px 26px 0 rgb(230, 0, 68);
      }

      h1 .big {
        font-size: 48pt;
        float: right;
      }

      h1 .small {
        font-size: 16pt;
        font-weight: 100;
        float: left;
        padding-top: 31pt;
      }

      h2 {
        padding-bottom: 7px;
        margin-bottom: 13px;
        border-bottom: 3px solid rgb(255, 0, 73);

        overflow: hidden;

text-shadow: 1px  1px 0 rgb(240, 245, 245), 2px  2px 0 rgb(240, 245, 245), 3px  3px 0 rgb(240, 245, 245), 4px  4px 0 rgb(240, 245, 245), 5px  5px 0 rgb(240, 245, 245), 6px  6px 0 rgb(240, 245, 245), 7px  7px 0 rgb(240, 245, 245), 8px  8px 0 rgb(240, 245, 245), 9px  9px 0 rgb(240, 245, 245),10px 10px 0 rgb(240, 245, 245),11px 11px 0 rgb(240, 245, 245),12px 12px 0 rgb(240, 245, 245),13px 13px 0 rgb(240, 245, 245),14px 14px 0 rgb(240, 245, 245),15px 15px 0 rgb(240, 245, 245),16px 16px 0 rgb(240, 245, 245),17px 17px 0 rgb(240, 245, 245),18px 18px 0 rgb(240, 245, 245),19px 19px 0 rgb(240, 245, 245),20px 20px 0 rgb(240, 245, 245),21px 21px 0 rgb(240, 245, 245),22px 22px 0 rgb(240, 245, 245),23px 23px 0 rgb(240, 245, 245),24px 24px 0 rgb(240, 245, 245),25px 25px 0 rgb(240, 245, 245),26px 26px 0 rgb(240, 245, 245);
      }

      p, ul {
        font-family: 'Roboto';
        font-size: 15pt;
        font-weight: 100;
        margin-bottom: 10px;
      }

      p + h2, .logos {
        border-top: 1px solid rgb(200, 200, 200);
        margin-top: 40px;
        padding-top: 40px;
      }

      a {
        text-decoration: none;
        display: inline-block;

        text-align: center;
        /*font-weight: 900;*/
        color: inherit;

        box-shadow: inset 0 -2px 0 0 rgba(50, 50, 50, 0.1);
      }

      a:hover {
        box-shadow: inset 0 -2px 0 0 rgb(255, 0, 73);
      }

      div.panel {
        display: inline-block;
        width: 50%;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        -ms-box-sizing: border-box;
        -o-box-sizing: border-box;
        box-sizing: border-box;
      }

      div.code {
        position: relative;
      }

      div.code:before {
        display: block;

        /*content: '⇨';*/
        content: '→';
        /*content: '⇾';*/
        /*content: '⇢';*/
        font-size: 3em;
        color: black;
        /*opacity: 0.2;*/

        line-height: 40px;
        height: 40px;
        width: 100%;
        text-align: center;

        position: absolute;
        pointer-events: none;
      }

      div.code h3 {
        text-align: center;
        padding: 10px;
      }

      .button, .button:hover {
        display: inline-block;
        
        border: none;
        border-radius: 2px;
        padding: 10px 20px 12px 20px;
        margin-bottom: 10px;

        text-align: center;
        font-size: 1em;
        font-weight: 900;
        color: white;

        box-shadow: inset 0 -2px 0 0 rgba(50, 50, 50, 0.2);
        background: rgb(255, 0, 73);
        overflow: hidden;

        text-shadow: 1px  1px 0 rgb(230, 0, 68), 2px  2px 0 rgb(230, 0, 68), 3px  3px 0 rgb(230, 0, 68), 4px  4px 0 rgb(230, 0, 68), 5px  5px 0 rgb(230, 0, 68), 6px  6px 0 rgb(230, 0, 68), 7px  7px 0 rgb(230, 0, 68), 8px  8px 0 rgb(230, 0, 68), 9px  9px 0 rgb(230, 0, 68),10px 10px 0 rgb(230, 0, 68),11px 11px 0 rgb(230, 0, 68),12px 12px 0 rgb(230, 0, 68),13px 13px 0 rgb(230, 0, 68),14px 14px 0 rgb(230, 0, 68),15px 15px 0 rgb(230, 0, 68),16px 16px 0 rgb(230, 0, 68),17px 17px 0 rgb(230, 0, 68),18px 18px 0 rgb(230, 0, 68),19px 19px 0 rgb(230, 0, 68),20px 20px 0 rgb(230, 0, 68),21px 21px 0 rgb(230, 0, 68),22px 22px 0 rgb(230, 0, 68),23px 23px 0 rgb(230, 0, 68),24px 24px 0 rgb(230, 0, 68),25px 25px 0 rgb(230, 0, 68),26px 26px 0 rgb(230, 0, 68);
      }

      .buttons {
        text-align: center;
        margin-top: 30px;
      }

      .buttons .button + .button {
        margin-left: 30px;
      }

      ul {
        padding-left: 100px;
      }

      li {
        margin-left: 20px;
      }

      .warning img {
        float: left;
        width : 75px;
        margin-right: 30px;
        padding-top: 20px;
      }

      .logos {
        margin-top: 50px;

      }

      .logos a {
        box-shadow: none;
      }

      .logos a:hover {
        filter: invert(100%) brightness(0.4) sepia(100%) saturate(1000%) hue-rotate(138deg) invert(100%);
      }

      .logos img {
        height: 39px;
      }

      .logos a + a {
        margin-left: 20px;
      }

      span.code {
        display: inline-block;
        /*border-radius: 2px;*/
        /*background: rgba(120, 120, 120, 0.1);*/
        border: 1px solid rgba(120, 120, 120, 0.15);
        padding: 0 4px;
        margin: -1px;
        font-family: "Inconsolata";
      }

      span.italic {
        font-style: italic;
        font-weight: 100;
      }

      span.emph {
        font-weight: 900;
      }

      .crowd::before {
        font-family: "FontAwesome";
        content: "";
      }

    </style>
</head>

<body>
  <h1>
  <span class='small'>A first step toward a Callback to Promise compiler</span>
  <span class="big">Due</span>
  </h1>

  <h2>How to make your callbacks behave well ?</h2>
  <p>
  If you use to write asynchronous Javascript code, you might have encounter the <a href="http://callbackhell.com/">Callback hell</a> <span class='italic'>aka</span> Pyramid of Doom.
  To avoid this pattern, you need to cleanly arrange your asynchronous execution flow, for example with Promises.
  </p>

  <p>
  A Promise is a cleaner pattern allowing to write asynchronous sequence as a cascade of call, instead of a pyramide of call.
  They are coming in ECMAScript 6, but in the meantime, you can use Dues.
  </p>

  <h2>What are Dues ?</h2>
  <p>
  Dues are like Promises, they provide the chainable <span class="code">then</span> method.
  However, they expect only one callbacks following the error-first convention.
  </p>

<div class="code">
<div class="panel">
<h3>Classic Javascript</h3>
<pre class="code line-numbers">
<code class="language-javascript">
var my_fn = require('./my-fn'),
    arg1 = 'A',
    arg2 = 'B';

my_fn(arg1, 
  function cont1(err, res) {
    my_fn(arg1 + ', ' + arg2,

      function cont2(err, res) {
        console.log(res);
      });
  });<!-- 
 --></code></pre></div><!-- 
 --><div class="panel">
<h3>Javascript + Dues</h3>
<pre class="code line-numbers">
<code class="language-javascript">
var my_fn = require('./my-fn'),
    arg1 = 'A',
    arg2 = 'B',

my_fn(arg1)
.then(function cont1(err, res) {
  return my_fn(arg1 + ', ' + arg2);
})
.then(function cont2(err, res) {
  console.log(res);
});
</code></pre></div>
</div>

  <p></p>


  <h2>It's time to switch !</h2>

  <p>
  You can find the Due package on <a href="https://www.npmjs.com/package/due">npm</a> and on <a href="https://github.com/etnbrd/due">github</a>.
  </p>


  <p>
  In the meantime, you might already have tons of lines that you don't want to refactor manually.
  </p>

  <p>
  <span class="emph">And Oh, here is a compiler to update your code.</span> Available in two flavors.
  </p>

  <p class='buttons'>
    <a href="compiler.html" class="button">single file compiler</a> <a href="repo-compiler.html" class="button">project compiler</a>
  </p>

  <p class='warning'>
    <img src="images/warning.png">
  </p>

  <ul>Before using the compiler, be aware that :
    <li>Your code can not contain <span class='code'>eval</span> or <span class='code'>with</span></li>
    <li>The callback must be a continuation : called asynchronously and only once.</li>
    <li>This continuation must be a <span class='code'>FunctionExpression</span>.</li>
    <li>Any value returned by the continuation or the callee can't be retrieved.<!-- For example the timer identifier returned by <span class='code'>SetTimeout</span>. --></li>
  </ul>

  <p>
    The compiler asks you to confirm that the couples callee / callback founds meet this above conditions.
    The symbol <span class='crowd'></span> indicates what the community already indicated about it.
  </p>

  <p class="logos">
    <a href="http://worldline.com/en-us/home.html"><img src="images/logo-worldline.png"></a>
    <a href="http://www.citi-lab.fr/citilab/people/"><img src="images/logo-citi.png"></a>
    <a href="http://www.insa-lyon.fr/"><img src="images/logo-insa.png"></a>
    <a href="http://www.inria.fr/en/"><img src="images/logo-inria.png"></a>
    <a href="http://www.rhonealpes.fr/"><img src="images/logo-rhonealpes.png"></a>
  </p>

  <script src="scripts/prism.js" type="text/javascript"></script>

  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56276105-2', 'auto');
    ga('send', 'pageview');
  </script>


</body>
</html>